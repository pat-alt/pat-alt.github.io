{
  "hash": "7c0e6dd894580da2e38447f80c8c3678",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: What's new in [T]{style=\"color:#389836;\"}rustworthy [AI]{style=\"color:#9558B2;\"} in [J]{style=\"color:#CB3C33;\"}uli[A]{style=\"color:#CB3C33;\"}?\nsubtitle: JuliaCon 2024\nauthor: Patrick Altmeyer\nformat:\n  julia-revealjs: \n    scrollable: true\n    title-slide-attributes:\n      data-background-image: ../www/qr.png\n    self-contained: true\ndate: 2024-07-11\ndate-format: full\nbibliography: biblio.bib\nexecute:\n  freeze: auto\n  eval: true\n  echo: true\n  output: false\n---\n\n\n\n# What's [Taija](https://github.com/JuliaTrustworthyAI)?\n\nTaija is a small but growing ecosystem of packages geared towards [T]{style=\"color:#389836;\"}rustworthy [AI]{style=\"color:#9558B2;\"} in [J]{style=\"color:#CB3C33;\"}uli[A]{style=\"color:#CB3C33;\"}---[Taija](https://github.com/JuliaTrustworthyAI)\n\n[![Trustworthy AI in Julia: github.com/JuliaTrustworthyAI](www/logo.png){width=\"50%\" fig-align=\"center\"}](https://github.com/JuliaTrustworthyAI)\n\n## Ecosystem Overview\n\n\n```{mermaid}\n%%| echo: false\n%%| label: fig-overview\n%%| fig-cap: \"Overview of the Taija ecosystem. Early-stage packages omitted.\"\n\n%%{\n  init: {\n    'theme': 'base',\n    'themeVariables': {\n      'primaryColor': '#BB2528',\n      'primaryTextColor': '#fff',\n      'primaryBorderColor': '#7C0000',\n      'lineColor': '#F8B229',\n      'secondaryColor': '#006100',\n      'tertiaryColor': '#e9edfb',\n      'fontFamily': \"avenir\"\n    }\n  }\n}%%\n\nflowchart TB\n\n    classDef taija fill:#389836,stroke:#333,color:#fff;\n    classDef core fill:#CB3C33,stroke:#333,color:#fff;\n    classDef base fill:#9558B2,stroke:#333,color:#fff;\n\n    %% Base\n    base[\"TaijaBase.jl\"]\n\n    %% Meta\n    interop[\"TaijaInteroperability.jl\"]\n    data[\"TaijaData.jl\"]\n    parallel[\"TaijaParallel.jl\"]\n    plotting[\"TaijaPlotting.jl\"]\n\n    %% Core\n    ce[\"CounterfactualExplanations.jl\"]\n    cp[\"ConformalPrediction.jl\"]\n    lr[\"LaplaceRedux.jl\"]\n    jem[\"JointEnergyModels.jl\"]\n\n    %% External\n    mlj[\"MLJ.jl\"]\n    flux[\"Flux.jl\"]\n\n    class base base;\n    class interop,data,parallel,plotting taija;\n    class ce,cp,lr,jem core;\n\n    %% Graph\n    base --> ce & cp & lr & jem\n\n    subgraph \"Core Packages\"\n        ce & cp & lr & jem \n    end\n\n    subgraph \"Meta Packages\"\n        data & plotting & parallel & interop\n    end \n\n    subgraph \"External Packages\"\n        mlj & flux\n    end\n```\n\n\n\n## Who's behind Taija?\n\n- **2021-2022**: Initially developed by myself to support my PhD research in Trustworthy AI (still ongoing).\n- **2023-2024**: Expanded by a growing community of contributors, including TU Delft and G/JSoC students.\n\n> Thanks to [\\@MojiFarmanbar](https://github.com/orgs/JuliaTrustworthyAI/people/MojiFarmanbar), [\\@JorgeLuizFranco](https://github.com/orgs/JuliaTrustworthyAI/people/JorgeLuizFranco), [\\@Rockdeldiablo](https://github.com/orgs/JuliaTrustworthyAI/people/Rockdeldiablo), [\\@kmariuszk](https://github.com/orgs/JuliaTrustworthyAI/people/kmariuszk), [\\@RaunoArike](https://github.com/orgs/JuliaTrustworthyAI/people/RaunoArike), [\\@VincentPikand](https://github.com/orgs/JuliaTrustworthyAI/people/VincentPikand), [\\@severinbratus](https://github.com/orgs/JuliaTrustworthyAI/people/severinbratus), [\\@rithik83](https://github.com/orgs/JuliaTrustworthyAI/people/rithik83), [\\@navimakarov](https://github.com/orgs/JuliaTrustworthyAI/people/navimakarov), [\\@laurikskl](https://github.com/orgs/JuliaTrustworthyAI/people/laurikskl), [\\@MarkArdman](https://github.com/orgs/JuliaTrustworthyAI/people/MarkArdman), [\\@adelinacazacu](https://github.com/orgs/JuliaTrustworthyAI/people/adelinacazacu), [\\@Andrei32Ionescu](https://github.com/orgs/JuliaTrustworthyAI/people/Andrei32Ionescu) and many [others](https://github.com/orgs/JuliaTrustworthyAI/people)!\n\n## Use Cases\n\n> Who could benefit from Taija?\n\n:::{.incremental}\n\n- Researchers in AI and ML, particularly in the fields of explainability, uncertainty quantification, and Bayesian deep learning: (![](/www/profile.jpg){width=\"35px\"}, ...)\n- Practitioners using conventional ML and DL models who are interested in understanding the models' decisions and their uncertainty.\n- Julia developers who want to contribute to the ecosystem (any level of expertise is welcome!). \n\n:::\n\n# Research \n\n## Pick your Poison\n\nAll of these counterfactuals are valid explanations for the model's prediction. \n\n> Which one would you pick?\n\n![Turning a 9 into a 7: Counterfactual explanations for an image classifier produced using *Wachter* [@wachter2017counterfactual], *Schut* [@schut2021generating] and *REVISE* [@joshi2019realistic].](www/mnist_motivation.png){#fig-cf-example width=\"80%\"}\n\n## Faithful Counterfactuals\n\n::::{.columns}::::\n:::{.column width='32%'}\n![Turning a 9 into a 7. *ECCCo* applied to MLP (a), Ensemble (b), JEM (c), JEM Ensemble (d).](www/mnist_eccco.png){#fig-mnist-eccco width=\"75%\"}\n:::\n:::{.column width='68%'}\n*ECCCo*^[Source code [ECCCo.jl](https://github.com/pat-alt/ECCCo.jl) extends CE.jl, CP.jl and JEM.jl.] counterfactuals\n\n- faithfully represent model quality (@fig-mnist-eccco).\n- achieve state-of-the-art plausibility (@fig-mnist-benchmark).\n\n![Results for different generators (from 3 to 5).](www/mnist_benchmark.png){#fig-mnist-benchmark width=\"100%\"}\n:::\n::::\n\n## Intent Classification\n\nIntent classification (IC) in dialogue systems is a common task and a natural place for conformal prediction.\n\n::::{.columns}::::\n:::{.column width='50%'}\n- Simply returning top-1 softmax likely wrong.\n- Existing ad-hoc approach is top-$k$.\n- Conformal classifiers predict sets that fulfill coverage guarantee.\n:::\n:::{.column width='50%'}\n![A simple conformal chat bot in the Julia REPL using ConformalPrediction.jl.](www/conformal_bot.gif){#fig-llm}\n:::\n::::\n\n## Conformal IC and Clarification\n\n- Our NAACL 2024 [paper](https://aclanthology.org/2024.findings-naacl.156/) introduces CICC: a framework for fast and accurate intent classification in conversational AI.\n- Winning project at ING Experiment Week 2023.\n\n> See also [*Building a Conformal Chatbot in Julia*](https://www.patalt.org/blog/posts/conformal-llm/) with ConformalPrediction.jl and Transformers.jl^[Experiments in @hengst2024conformal were run in parallel using Python's MAPIE and ConformalPrediction.jl, in order to cross-check results. Reported results were produced using MAPIE.].\n\n## More Research\n\n- *Stop Making Unscientific AGI Performance Claims* [@altmeyer2024position] [upcoming](https://arxiv.org/abs/2402.03962) at *ICML 2024*.^[Our related [package](https://github.com/pat-alt/TrillionDollarWords.jl) is not currently part of Taija but may be in the future.]\n- *Endogenous Macrodynamics in Algorithmic Recourse* [@altmeyer2023endogenous] [published](https://ieeexplore.ieee.org/abstract/document/10136130) at *IEEE SaTML 2023*.\n- Various Master's theses on CE for imbalanced data [@zagorac2024study], CE for LLMs ([draft PR](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl/pull/413)), and more ...\n- Bachelor's theses on *What Makes Models Explainable? Evidence from Counterfactuals* (related development: [AdversarialRobustness.jl](https://github.com/JuliaTrustworthyAI/AdversarialRobustness.jl)). \n\n# Developments\n\n::::{.columns}::::\n:::{.column width='80%'}\nA brief overview of the highlights. For a more introductory presentation, see also this [slides](../../2024-turing/presentation.qmd){target=\"_blank\"} presentation The Alan Turing Institute \n:::\n:::{.column width='20%'}\n![](www/qr-turing.png)\n:::\n::::\n\n\n\n# What's new in ... {.nostretch}\n\n`CounterfactualExplanations.jl`: A [package](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl) for Counterfactual Explanations and Algorithmic Recourse in Julia.\n\n::::{.columns}::::\n:::{.column width='40%'}\n- refactoring (e.g. package extensions)\n- performance improvements\n- new features\n:::\n:::{.column width='60%'}\n- JCon Proceedings [@altmeyer2023explaining].\n[![](www/ce_logo.png){width=\"100%\" fig-align=\"right\"}](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl)\n:::\n::::\n\n## Composable Generators\n\nThe largest single category of CE methods solves the following optimization through gradient descent:\n\n$$\n\\begin{aligned}\n\\mathbf{s}^* &= \\arg \\min_{\\mathbf{s}^\\prime \\in \\mathcal{S}} \\left\\{  {\\text{yloss}(M(f(\\mathbf{s}^\\prime)),y^*)}+ \\lambda {\\text{cost}(f(\\mathbf{s}^\\prime)) }  \\right\\} \n\\end{aligned} \n$$ \n\n. . .\n\n> Why not compose generators that combine ideas from different off-the-shelf generators?\n\n. . .\n\n```{.julia}\n@chain generator begin\n    @objective logitcrossentropy \n      + 1.0ddp_diversity     # DiCE (Mothilal et al. 2020)\n    @with_optimiser Flux.Adam(0.1)                      \n    @search_latent_space     # REVISE (Joshi et al. 2019)\nend\n```\n\n## Explaining Different Models\n\nBesides any Flux.jl model, package extensions add support for \n\n::::{.columns}::::\n:::{.column width='55%'}\n- [DecisionTree.jl](https://github.com/JuliaAI/DecisionTree.jl) \n- [NeuroTrees.jl](https://github.com/Evovest/NeuroTreeModels.jl) (see Jeremie's [talk](https://pretalx.com/juliacon2024/talk/D3BHTT/))\n- [LaplaceRedux.jl](https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl)\n- [JointEnergyModel.jl](https://github.com/JuliaTrustworthyAI/JointEnergyModels.jl) (upcoming)\n:::\n:::{.column width='45%'}\n![Counterfactual for differentiable decision tree classifier.](www/neurotree.svg)\n:::\n::::\n\n\n## Benchmarking Explanations\n\nExtensive support for evaluating and benchmarking explanations.\n\n::::{.columns}::::\n:::{.column width='50%'}\n\n#### Evaluation\n\n```{.julia}\n# Generate counterfactuals\nces = generate_counterfactual(\n  factual, \n  target_label, \n  data, \n  M, \n  generator; \n  num_counterfactuals=5\n)\n\n# Evaluate them\nevaluate(ces)\n```\n\n:::\n:::{.column width='50%'}\n\n#### Benchmarks\n\nBenchmark all available generators and models at once in parallel^[[TaijaParallel.jl](https://github.com/JuliaTrustworthyAI/TaijaParallel.jl) adds support for parallelization. [Join](https://pretalx.com/juliacon2024/me/submissions/XLCNXN/) Friday 11:50–12:00, Else (1.3)]:\n\n```{.julia}\nusing TaijaParallel\npllr = ThreadsParallelizer()\nbmk = benchmark(\n  counterfactual_data; \n  parallelizer = pllr\n)\n```\n:::\n::::\n\n# What's new in ... {.nostretch}\n\n`LaplaceRedux.jl`: A [package](https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl) for Effortless Bayesian Deep Learning through Laplace Approximation for Flux.jl neural networks.\n\n::::{.columns}::::\n:::{.column width='50%'}\n- new features\n- interface to MLJ\n- JCon Proceedings (under review).\n:::\n:::{.column width='50%'}\n[![](www/lr_logo.png){width=\"100%\" fig-align=\"right\"}](https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl)\n:::\n::::\n\n## Student Contributions\n\n- Support for multi-class problems. \n- Support for more scalable Hessian approximations.\n- Interface to MLJ for easy model training and evaluation.\n\n![Hessian approximations. Source: @daxberger2021laplace](www/fact.png){#fig-fact}\n\n> Check out their [blog post](https://www.patalt.org/blog/posts/guest-students-laplace/)!\n\n# What's new in ... {.nostretch}\n\n`ConformalPrediction.jl`: A [package](https://github.com/JuliaTrustworthyAI/ConformalPrediction.jl) for Predictive Uncertainty Quantification through Conformal Prediction for Machine Learning models trained in MLJ.\n\n::::{.columns}::::\n:::{.column width='60%'}\n- refactoring\n- new features ([\\@MojiFarmanbar](https://github.com/orgs/JuliaTrustworthyAI/people/MojiFarmanbar))\n  - [Time Series](https://juliatrustworthyai.github.io/ConformalPrediction.jl/stable/how_to_guides/timeseries/)\n  - [Quantile Regression](https://github.com/JuliaTrustworthyAI/ConformalPrediction.jl/pull/96)\n:::\n:::{.column width='40%'}\n[![](www/cp_logo.png){width=\"100%\" fig-align=\"right\"}](https://github.com/JuliaTrustworthyAI/ConformalPrediction.jl)\n:::\n::::\n\n# Joint Energy Models \n\n`JointEnergyModels.jl`: A [package](https://github.com/JuliaTrustworthyAI/JointEnergyModels.jl?tab=readme-ov-file) for Joint Energy-Based Models Models in Julia (early development).\n\n::::{.columns}::::\n:::{.column width='50%'}\nHybrid models that can predict and generate [@grathwohl2020your].\n\n- Flux.jl interface\n- MLJFlux.jl interface\n:::\n:::{.column width='50%'}\n\n![Predicted output class probabilities (contour) and generated inputs (stars) for a binary JEM classifier.](www/jem.png){#fig-jem width=\"100%\"}\n\n:::\n::::\n\n# Final Things\n\n## Ongoing Work\n\nTaija has been running two Julia Season of Code projects this summer.\n\n1. (*Conformal Bayes*) Bridging the gap between Bayesian and frequentist approaches to Predictive Uncertainty Quantification with [\\@Rockdeldiablo](https://github.com/orgs/JuliaTrustworthyAI/people/Rockdeldiablo) and co-supervisor [\\@MojiFarmanbar](https://github.com/orgs/JuliaTrustworthyAI/people/MojiFarmanbar)\n2. (*Causal Recourse*) From minimal perturbations to minimal interventions for Algorithmic Recourse with [\\@JorgeLuizFranco](https://github.com/orgs/JuliaTrustworthyAI/people/JorgeLuizFranco) and co-supervisor [\\@mschauer](https://github.com/mschauer).\n\n## Student Testimonials\n\nStudents have generally been enthusiastic about their experience with Julia and Taija:\n\n> \"Programming in Julia has definitely helped us become better programmers. [...] whenever we had such questions and asked them [to] the wider Julia community, there were always people ready to help in my experience, which was nice.\" \n> \n> --- [\\@RaunoArike](https://github.com/orgs/JuliaTrustworthyAI/people/RaunoArike)\n\n## Get Involved\n\n- Working on related projects?\n- Interested in contributing to Taija?\n- Want to learn more about Trustworthy AI in Julia?\n- Any suggestions or feedback?\n\n> Get in touch with me or any of the contributors! Join our \\#taija channel on the [JuliaLang Slack](https://julialang.org/slack/) or visit our [GitHub organization](https://github.com/JuliaTrustworthyAI).\n\n# Questions? {.nostretch} \n\n![](/www/images/qr.png){width=\"25%\" fig-align=\"center\"}\n\n## References\n\n",
    "supporting": [
      "presentation_files"
    ],
    "filters": [],
    "includes": {}
  }
}