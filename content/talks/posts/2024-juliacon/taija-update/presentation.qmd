---
title: What's new in [T]{style="color:#389836;"}rustworthy [AI]{style="color:#9558B2;"} in [J]{style="color:#CB3C33;"}uli[A]{style="color:#CB3C33;"}?
subtitle: JuliaCon 2024
author: Patrick Altmeyer
format:
  julia-revealjs: 
    scrollable: true
date: last-modified
bibliography: biblio.bib
execute:
  freeze: auto
  eval: true
  echo: true
  output: false
---

```{julia}
#| echo: false

include("$(pwd())/content/talks/posts/2024-juliacon/taija-update/setup.jl")
```

# What's [Taija](https://github.com/JuliaTrustworthyAI)?

Taija is a small but growing ecosystem of packages geared towards *T*rustworthy *A*rtificial *I*ntelligence in *J*uli*a*---[Taija](https://github.com/JuliaTrustworthyAI).  

[![Trustworthy AI in Julia: github.com/JuliaTrustworthyAI](www/logo.png){width="50%" fig-align="center"}](https://github.com/JuliaTrustworthyAI)

## Ecosystem Overview

```{mermaid}
%%| echo: false
%%| label: fig-overview
%%| fig-cap: "Overview of the Taija ecosystem. Packages in early development not shown."

%%{
  init: {
    'theme': 'base',
    'themeVariables': {
      'primaryColor': '#BB2528',
      'primaryTextColor': '#fff',
      'primaryBorderColor': '#7C0000',
      'lineColor': '#F8B229',
      'secondaryColor': '#006100',
      'tertiaryColor': '#e9edfb',
      'fontFamily': "avenir"
    }
  }
}%%

flowchart TB

    classDef taija fill:#389836,stroke:#333,color:#fff;
    classDef core fill:#CB3C33,stroke:#333,color:#fff;
    classDef base fill:#9558B2,stroke:#333,color:#fff;

    %% Base
    base["TaijaBase.jl"]

    %% Meta
    interop["TaijaInteroperability.jl"]
    data["TaijaData.jl"]
    parallel["TaijaParallel.jl"]
    plotting["TaijaPlotting.jl"]

    %% Core
    ce["CounterfactualExplanations.jl"]
    cp["ConformalPrediction.jl"]
    lr["LaplaceRedux.jl"]
    jem["JointEnergyModels.jl"]

    %% External
    mlj["MLJ.jl"]
    flux["Flux.jl"]

    class base base;
    class interop,data,parallel,plotting taija;
    class ce,cp,lr,jem core;

    %% Graph
    base --> ce & cp & lr & jem

    subgraph "Core Packages"
        ce & cp & lr & jem 
    end

    subgraph "Meta Packages"
        data & plotting & parallel & interop
    end 

    subgraph "External Packages"
        mlj & flux
    end
```


## Who's behind Taija?

- **2021-2022**: Initially developed by myself to support my PhD research in Trustworthy AI.
- **2023-2024**: Expanded by a growing community of contributors, including TU Delft and G/JSoC students.

> Thanks to [\@MojiFarmanbar](https://github.com/orgs/JuliaTrustworthyAI/people/MojiFarmanbar), [\@JorgeLuizFranco](https://github.com/orgs/JuliaTrustworthyAI/people/JorgeLuizFranco), [\@Rockdeldiablo](https://github.com/orgs/JuliaTrustworthyAI/people/Rockdeldiablo), [\@kmariuszk](https://github.com/orgs/JuliaTrustworthyAI/people/kmariuszk), [\@RaunoArike](https://github.com/orgs/JuliaTrustworthyAI/people/RaunoArike), [\@VincentPikand](https://github.com/orgs/JuliaTrustworthyAI/people/VincentPikand), [\@severinbratus](https://github.com/orgs/JuliaTrustworthyAI/people/severinbratus), [\@rithik83](https://github.com/orgs/JuliaTrustworthyAI/people/rithik83), [\@navimakarov](https://github.com/orgs/JuliaTrustworthyAI/people/navimakarov), [\@laurikskl](https://github.com/orgs/JuliaTrustworthyAI/people/laurikskl), [\@MarkArdman](https://github.com/orgs/JuliaTrustworthyAI/people/MarkArdman), [\@adelinacazacu](https://github.com/orgs/JuliaTrustworthyAI/people/adelinacazacu), [\@Andrei32Ionescu](https://github.com/orgs/JuliaTrustworthyAI/people/Andrei32Ionescu) and many [others](https://github.com/orgs/JuliaTrustworthyAI/people)!

## Use Cases

> Who could benefit from Taija?

:::{.incremental}

- Researchers in AI and ML, particularly in the fields of explainability, uncertainty quantification, and Bayesian deep learning: (![](/www/profile.jpg){width="35px"}, ...)
- Practitioners using conventional ML and DL models who are interested in understanding the models' decisions and their uncertainty.
- Julia developers who want to contribute to the ecosystem (any level of expertise is welcome!). 

:::

# Research 

## Pick your Poison

All of these counterfactuals are valid explanations for the model's prediction. 

> Which one would you pick?

![Turning a 9 into a 7: Counterfactual explanations for an image classifier produced using *Wachter* [@wachter2017counterfactual], *Schut* [@schut2021generating] and *REVISE* [@joshi2019realistic].](www/mnist_motivation.png){#fig-cf-example width="80%"}

## Faithful Counterfactuals

::::{.columns}::::
:::{.column width='32%'}
![Turning a 9 into a 7. *ECCCo* applied to MLP (a), Ensemble (b), JEM (c), JEM Ensemble (d).](www/mnist_eccco.png){#fig-mnist-eccco width="75%"}
:::
:::{.column width='68%'}
*ECCCo*^[Source code [ECCCo.jl](https://github.com/pat-alt/ECCCo.jl) extends CE.jl, CP.jl and JEM.jl.] generates counterfactuals that

- faithfully represent model quality (@fig-mnist-eccco).
- achieve state-of-the-art plausibility (@fig-mnist-benchmark).

![Results for different generators (from 3 to 5).](www/mnist_benchmark.png){#fig-mnist-benchmark width="100%"}
:::
::::

## Conformal Intent Classification



## More Research

- *Endogenous Macrodynamics in Algorithmic Recourse* [@altmeyer2023endogenous] [published](https://ieeexplore.ieee.org/abstract/document/10136130) at *IEEE SaTML 2023*.

#### Students

- Bachelor's thesis on *What Makes Models Explainable? Evidence from Counterfactuals* (work in progress). 
    - Related development: [AdversarialRobustness.jl](https://github.com/JuliaTrustworthyAI/AdversarialRobustness.jl).
- Various Master's theses on CE for imbalanced data [@zagorac2024study], CE as a tool for testing, operationalizing algorithmic recourse, explainability of LLMs (see [draft PR](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl/pull/413)).

# Developments

## Overview

- [CounterfactualExplanations.jl](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl): refactoring, performance improvements, new features, JCon Proceedings [@altmeyer2023explaining].
- [LaplaceRedux.jl](https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl): new features, interface to MLJ, JCon Proceedings (under review).
- [ConformalPrediction.jl](https://github.com/JuliaTrustworthyAI/ConformalPrediction.jl): new features.
- [JointEnergyModels.jl](https://github.com/JuliaTrustworthyAI/JointEnergyModels.jl): new package for Joint Energy-Based Models [@grathwohl2020your].
- Meta packages: [TaijaData.jl](https://github.com/JuliaTrustworthyAI/TaijaData.jl), [TaijaParallel.jl](https://github.com/JuliaTrustworthyAI/TaijaParallel.jl), ...

## Composable Counterfactual Generators

## Explaining Different Models

NeuroTrees.jl

[Talk](https://pretalx.com/juliacon2024/talk/D3BHTT/)

## Benchmarking Counterfactuals

## Scaling Things Up

## New in LaplaceRedux.jl

## New in ConformalPrediction.jl

## Joint Energy-Based Models

## Ongoing Work

# Questions? {.nostretch} 

![](/www/images/qr.png){width="25%" fig-align="center"}

## References