---
title: Vertrauens(un)w√ºrdige KI durch Counterfactual Explanations
author: 
  - name: "**Patrick Altmeyer**"
    url: https://www.patalt.org/
  - name: Arie van Deursen
  - name: Cynthia C. S. Liem
institute: Technische Universit√§t Delft
date: today
format: 
  tudelft-revealjs:
    theme: custom.scss
    self-contained: true
    smaller: false
    scrollable: true
    preview-links: auto
    slide-number: true
    transition: slide
    background-transition: fade
    fig-align: center
    html-math-method: mathjax
    include-in-header:
      - text: |
          <script>
          MathJax = {
            options: {
              menuOptions: {
                settings: {
                  assistiveMml: false
                }
              }
            }
          };
          </script>
    lightbox: true
revealjs-plugins:
  - pointer
crossref: 
  prp-title: RQ
  prp-prefix: RQ
classoption: "notheorems"
---

## Kurz zu mir ...

::::{.columns}::::
:::{.column width='75%'}
- MA Hons Economics an der *University of Edinburgh*, dann Master in Economics and Finance an der *Barcelona School of Economics* (BSE)
- Zwei Jahre Geldpolitik bei der *Bank of England*, dann Master in Data Science an der BSE.
- Heute Doktorand im Fachbereich Vertrauensw√ºrdige KI an der *Technischen Universit√§t Delft*.
:::
:::{.column width='25%'}
> Hier geht's zur Website:
> ![](/www/images/qr.png){width="100%" fig-align="center"}
:::
::::

# Wieso? Weshalb? Warum?

> ‚ÄúYou cannot appeal to (algorithms). They do not listen. Nor do they bend.‚Äù
>
> ‚Äî Cathy O'Neil in [*Weapons of Math Destruction*](https://en.wikipedia.org/wiki/Weapons_of_Math_Destruction), 2016

## Agenda 

::: {.incremental}

- Einf√ºhrung: Counterfactual Explantions (@sec-intro).
- Probleme bei der Anwendung (@sec-praxis).
- Wer die Wahl hat ... (@sec-wahl).
- Vertrauensw√ºrdig oder nicht? (@sec-trust).
- Q&A (12:30-13:00) (@sec-questions).
<!-- - **Papers**: @altmeyer2023endogenous, @altmeyer2023explaining, @altmeyer2023faithful, @hengst2024conformal, @altmeyer2024position -->

:::

# Einf√ºhrung: Counterfactual Explantions {#sec-intro}

> Wenn das W√∂rtchen "wenn" nicht w√§r ...

## Problemstellung {auto-animate=true}

Typischerweise geht es um belangreiche diskrete Entscheidungen:

::: {.incremental}

- Kreditw√ºrdig oder nicht?
- Betrugsverdacht oder nicht?
- Stra√üenzulassung oder nicht?
- Krebs oder nicht?

:::

## Problemstellung {auto-animate=true}

Typischerweise geht es um belangreiche diskrete Entscheidungen:

::::{.columns}::::
:::{.column width='45%'}
#### Hund üê∂ oder Katze üê±?

![](www/class.png){width="70%" align="center"}
:::
:::{.column width='55%'}

::: {style="color: lightgrey;"}
- Kreditw√ºrdig oder nicht?
- Betrugsverdacht oder nicht?
- Stra√üenzulassung oder nicht?
- Krebs oder nicht?
:::
:::
::::

## Counterfactual Explanations

::::{.columns}::::
:::{.column width='50%'}
**Counterfactual Explanations** (CE) erkl√§ren welche Ver√§nderungen n√∂tig gewesen w√§ren, damit der Algorithmus eine andere Entscheidung trifft.^[Weitere einleitende Lekt√ºre: Blog [post](https://www.patalt.org/blog/posts/individual-recourse-for-black-box-models/) oder üìú @altmeyer2023explaining.]
:::
:::{.column width='50%'}
![](www/revise.gif)
:::
::::

# Probleme bei der Anwendung {#sec-praxis}

> "No such thing as a free lunch"

## Wer tr√§gt die Kosten? 

![](www/bank_cartoon.png){width="55%" fig-align="center"}

::::{.columns}::::
:::{.column width='50%'}
Individuelle Kostenminimierung ist nicht immer optimal.^[Mehr zu dem Thema in unserem SaTML üìú [@altmeyer2023endogenous].]
:::
:::{.column width='50%'}
![](www/poc.png){width="100%"}
:::
::::

## Verwandte Themen

# Wer die Wahl hat ... {#sec-wahl}

> ... hat meistens auch die Qual.

## Mangelnde Eindeutigkeit

::::{.columns}::::
:::{.column width='40%'}
- Erkl√§rungen f√ºr Algorithmen sind selten eindeutig.

- Diversit√§t kann sogar erw√ºnschlich sein [@mothilal2020explaining].
:::
:::{.column width='60%'}

![Diverse Erkl√§rungen durch CE. Quelle: @altmeyer2023explaining.](www/ce_intro.png){fig-align="center"}

:::
::::


## Viele Bed√ºrfnisse

::: {.incremental}

- **Proximit√§t**: individuelle Kostenminimierung [@wachter2017counterfactual].
- **Umsetzbarkeit**: nicht alle Ver√§nderungen sind m√∂glich [@ustun2019actionable].
- **Robustheit**: Erkl√§rungen sollten auch morgen noch g√ºltig sein [@upadhyay2021robust; @slack2021counterfactual; @pawelczyk2022probabilistically].
- **Plausibilit√§t**: nicht alle Ver√§nderungen sind plausibel [@joshi2019realistic; @poyiadzi2020face].

:::

# Vertrauensw√ºrdig oder nicht? {#sec-trust}

> Nicht alles, was gut aussieht, ist auch wirklich gut.

## Pick your Poison

Alle Erkl√§rungen in @fig-cf-example sind g√ºltig. 

> Welche nehmen wir?

![Aus 9 wird 7: CEs f√ºr einen Bildklassifikator generiert durch *Wachter* [@wachter2017counterfactual], *Schut* [@schut2021generating] and *REVISE* [@joshi2019realistic].](www/mnist_motivation.png){#fig-cf-example width="80%"}

## Treue trumpft Plausibilit√§t

::::{.columns}::::
:::{.column width='30%'}
![*ECCCos* f√ºr MLP (a), Ensemble (b), JEM (c), JEM Ensemble (d).](www/mnist_eccco.png){#fig-mnist-eccco width="75%"}
:::
:::{.column width='70%'}
*ECCCo* generiert CE die^[Mehr zum Thema in unserem AAAI üìú [@altmeyer2024faithful].]

- Qualit√§t treu repr√§sentiert (@fig-mnist-eccco).
- Plausibilit√§t erreicht (@fig-mnist-benchmark).

![Ergebnisse f√ºr verschiedene Generatoren (from 3 to 5).](www/mnist_benchmark.png){#fig-mnist-benchmark width="100%"}
:::
::::

## Robustness f√∂rdert Erkl√§rbarkeit


# Fragen? {#sec-questions}

## Taija {.smaller}

::::{.columns}::::
:::{.column width='50%'}
- Model Explainability ([CounterfactualExplanations.jl](https://github.com/JuliaTrustworthyAI/CounterfactualExplanations.jl))
- Predictive Uncertainty Quantification ([ConformalPrediction.jl](https://github.com/JuliaTrustworthyAI/ConformalPrediction.jl))
- Effortless Bayesian Deep Learning ([LaplaceRedux.jl](https://github.com/JuliaTrustworthyAI/LaplaceRedux.jl))
- ... and more!
:::
:::{.column width='50%'}
- Work presented \@ JuliaCon 2022, 2023, 2024.
- Running project \@ Google Summer of Code 2024.
- Total of three software projects \@ TU Delft.
:::
::::

[![Trustworthy AI in Julia: github.com/JuliaTrustworthyAI](www/logo.png){width="50%" fig-align="center"}](https://github.com/JuliaTrustworthyAI)

## References {.scrollable .smaller}


